{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://project2/./src/constants.js","webpack://project2/./src/listeners.js","webpack://project2/./src/polling.js","webpack://project2/./src/render.js","webpack://project2/./src/services.js","webpack://project2/./src/state.js","webpack://project2/webpack/bootstrap","webpack://project2/webpack/runtime/define property getters","webpack://project2/webpack/runtime/hasOwnProperty shorthand","webpack://project2/webpack/runtime/make namespace object","webpack://project2/./src/chat.js"],"sourcesContent":["export const SERVER = {\n    AUTH_MISSING: 'auth-missing',\n    AUTH_INSUFFICIENT: 'auth-insufficient',\n    REQUIRED_USERNAME: 'required-username',\n    INVALID_USERNAME: 'invalid-username',\n  };\n  \n  export const CLIENT = {\n    NETWORK_ERROR: 'network-error',\n    NO_SESSION: 'noSession',\n  };\n  \n  export const MESSAGES = {\n    [CLIENT.NETWORK_ERROR]: 'Trouble connecting to the network.  Please try again',\n    [SERVER.AUTH_MISSING]: 'Session id is invalid',\n    [SERVER.AUTH_INSUFFICIENT]: 'Your username/password combination does not match any records, please try again.',\n    [SERVER.REQUIRED_USERNAME]: 'The username can not be empty, please try again.',\n    [SERVER.INVALID_USERNAME]: 'Please enter a valid username of up to 20 characters (letters and/or numbers)',\n    default: 'Something went wrong.  Please try again',\n  };","import { fetchLogin, fetchLogout, fetchAddMessage } from './services'; // Offer fetch() calls to communicate with the server\nimport { waitOnMessages, addMessage, waitOnLogin, login, logout, setError } from './state'; // The user's state in client side\nimport {renderHomePage, renderLoginPage, renderMessageList} from './render'; // Offer the render methods to generate HTML\nimport polling from './polling'; // Set a polling to refresh the list of message and user\n\n/* Listen to the submit event of login form */\nexport function addListenerToLogin({ state,  rootEl }) {\n\n  // Using 'submit' to get both submit via button-click and by \"enter\"\n  rootEl.addEventListener('submit', (e) => {\n    e.preventDefault();\n    if(!e.target.classList.contains('login-form')) {\n      return;\n    }\n    const username = rootEl.querySelector('.login-to-send').value;\n\n    // Show loading state\n    waitOnLogin();\n    renderLoginPage({ state, rootEl });\n\n    // Make a login call\n    fetchLogin( username )\n    .then( res => {\n\n      // Login successful, show home page and set polling\n      login(res.username);\n      renderHomePage({ state, rootEl });\n      polling({ state, rootEl, isFirstTime: true });\n    })\n    .catch( err => {\n\n      // If there is an error, update state and show login page\n      logout();\n      setError(err?.error || 'ERROR');\n      renderLoginPage({ state, rootEl });\n    });\n  });\n}\n\n/* Listen to the click event of logout button */\nexport function addListenerToLogout({ state, rootEl }) {\n  rootEl.addEventListener('click', (e) => {\n    if(!e.target.classList.contains('logout-to-submit')) {\n      return;\n    }\n\n    // Update state and show login page\n    logout();\n    renderLoginPage({ state, rootEl });\n\n    // Make a logout call\n    fetchLogout()\n    .catch( err => {\n      setError(err?.error || 'ERROR');\n      renderLoginPage({ state, rootEl });\n    });\n  });\n}\n\n/* Listen to the submit event of outgoing form */\nexport function addListenerToOutgoing({ state,  rootEl }) {\n\n  // Using 'submit' to get both submit via button-click and by \"enter\"\n  rootEl.addEventListener('submit', (e) => {\n    e.preventDefault();\n    if(!e.target.classList.contains('outgoing-form')) {\n      return;\n    }\n\n    // Get the element of the send message input\n    const toSendEl = rootEl.querySelector('.outgoing-to-send');\n\n    // Get the element of the send message button\n    const sendButtonEl = rootEl.querySelector('.outgoing-to-submit');\n\n    // Get the element of messages' list\n    const messagesEl = rootEl.querySelector('.messages');\n\n    // Show loading state of messages' list\n    waitOnMessages();\n    renderMessageList({ state, messagesEl});\n\n    // Make a call to send a new message\n    fetchAddMessage( toSendEl.value )\n    .then( newMessage => {\n\n      // Show messages' list\n      addMessage(newMessage);\n      renderMessageList({ state, messagesEl});\n\n      // See the most recent messages\n      messagesEl.scrollTop = messagesEl.scrollHeight;\n\n      // Clear the value of the send message input\n      toSendEl.value = '';\n\n      // Set the disabled attribute of the send message button\n      sendButtonEl.disabled = !toSendEl.value;\n    })\n    .catch( err => {\n\n      // If there is an error, update state and show login page\n      logout();\n      setError(err?.error || 'ERROR');\n      renderLoginPage({ state, rootEl });\n    });\n\n  });\n}\n\n/* Update the disabled attribute of the login button */\nexport function addListenerToLoginSend(rootEl) {\n  rootEl.addEventListener('input', (e) => {\n    if(!e.target.classList.contains('login-to-send')) {\n      return;\n    }\n    const sendButtonEl = rootEl.querySelector('.login-to-submit');\n    sendButtonEl.disabled = !e.target.value; // If it has a value, set \"disabled\" to false\n  });\n}\n\n/* Update the disabled attribute of the send message button */\nexport function addListenerToOutgoingSend(rootEl) {\n  rootEl.addEventListener('input', (e) => {\n    if(!e.target.classList.contains('outgoing-to-send')) {\n      return;\n    }\n    const sendButtonEl = rootEl.querySelector('.outgoing-to-submit');\n    sendButtonEl.disabled = !e.target.value; // If it has a value, set \"disabled\" to false\n  });\n}","import { setTimeoutId } from './state'; // The user's state in client side\nimport { fetchLoggedInUsers, fetchMessages} from './services'; // Offer fetch() calls to communicate with the server\nimport { waitOnUsers, setUsers, waitOnMessages, setMessages, logout, setError } from './state'; // The user's state in client side\nimport { renderLoginPage, renderUserList, renderMessageList } from './render'; // Offer the render methods to generate HTML\n\n/* Every 5 seconds (roughly) refresh the list of message and users */\nexport default function polling({ state, rootEl, isFirstTime }) {\n\n  // Refresh the list of message and users\n  refreshUserList({state, rootEl});\n  refreshMessageList({state, rootEl, forceScrollToBottom: isFirstTime});\n\n  // Update the Timeout Id into state\n  const id = setTimeout( polling, 5000, { state, rootEl, isFirstTime: false } );\n  setTimeoutId(id);\n}\n\n/* Make a call to get the lists of logged-in user, then show lists */\nfunction refreshUserList({ state, rootEl }) {\n  const usersEl = rootEl.querySelector('.users');\n\n  // Show loading state of users' list\n  waitOnUsers();\n  renderUserList({state, usersEl});\n\n  // Make a call to get the logged-in users' list\n  fetchLoggedInUsers()\n  .then( users => {\n\n    // Show users' list\n    setUsers(users);\n    renderUserList({state, usersEl});\n  })\n  .catch( err => {\n\n    // If there is an error, update state and show login page\n    logout();\n    setError(err?.error || 'ERROR');\n    renderLoginPage({state, rootEl});\n  });\n}\n\n/* Make a call to get the lists of message, then show lists */\nfunction refreshMessageList({ state, rootEl, forceScrollToBottom }) {\n  const messagesEl = rootEl.querySelector('.messages');\n\n  // Check the scrolling status of messages' list\n  const needScrollToBottom = forceScrollToBottom ? true : (messagesEl.scrollHeight - messagesEl.scrollTop) < (messagesEl.clientHeight + 33);\n\n  // Save the previous scrollTop of messagesEl\n  const preScrollTop = messagesEl.scrollTop;\n\n  // Show loading state of messages' list\n  waitOnMessages();\n  renderMessageList({state, messagesEl});\n\n  // Make a call to get the messages' list\n  fetchMessages()\n  .then( messages => {\n\n    // Show messages' list\n    setMessages(messages);\n    renderMessageList({state, messagesEl});\n\n    if(needScrollToBottom) { // Scroll to the bottom\n      messagesEl.scrollTop = messagesEl.scrollHeight;\n    } else { // Keep in the same position\n      messagesEl.scrollTop = preScrollTop;\n    }\n  })\n  .catch( err => {\n\n    // If there is an error, update state and show login page\n    logout();\n    setError(err?.error || 'ERROR');\n    renderLoginPage({state, rootEl});\n  });\n}","function generateHomePageHtml(state) {\n  if(state.isLoginPending) {\n    return generateSpinnerHtml();\n  }\n  return `\n    <div class=\"home\">\n      <p class=\"user-greeting\">Hello <span class=\"user-title\">${state.username}</span></p>\n      <div class=\"logout-form\">\n        <button type=\"submit\" class=\"logout-to-submit\">Logout</button>\n      </div>\n      <div class=\"messages\">\n        ${generateMessageListHtml(state)}\n      </div>\n      <div class=\"users\">\n        ${generateUserListHtml(state)}\n      </div>\n      ${generateOutgoingHtml()}\n    </div>\n  `;\n}\n\nfunction generateMessageListHtml (state) {\n  if(state.isMessagesPending) {\n    return generateSpinnerHtml();\n  }\n\n  if(state.messages.length == 0) {\n    return `<p class=\"no-data\">No Message</p>`;\n  }\n\n  const listHtml = state.messages.map( msg => `\n    <li>\n      <div class=\"message\">\n        <div class=\"message-info\">\n          <img class=\"messages-avatar\" alt=\"avatar of ${msg.username}\" src=\"images/cat.png\"/>\n          <span class=\"messages-username\">${msg.username}</span>\n        </div>\n        <p class=\"message-text\">${msg.message}</p>\n      </div>\n    </li>\n  `).join('');\n  return `\n    <ul class=\"messages-list\">\n      ${listHtml}\n    </ul>\n  `;\n}\n\nfunction generateUserListHtml(state) {\n  if(state.isUsersPending) {\n    return generateSpinnerHtml();\n  }\n\n  if(state.users.length == 0) {\n    return `<p class=\"no-data\">No Users</p>`;\n  }\n\n  const listHtml = state.users.map((user) => `\n    <li>\n      <div class=\"user\">\n        <img class=\"user-avatar\" alt=\"avatar of ${user.username}\" src=\"images/cat.png\"/>\n        <span class=\"user-username\">${user.username}</span>\n      </div>\n    </li>\n  `).join('');\n\n  return `\n    <ul class=\"users-list\">\n      ${listHtml}\n    </ul>\n  `;\n}\n\nfunction generateOutgoingHtml() {\n  return `<div class=\"outgoing\">\n    <form class=\"outgoing-form\" action=\"#/add\">\n      <input type=\"text\" name=\"text\" class=\"outgoing-to-send\" value=\"\" placeholder=\"Enter message to send\"/>\n      <button type=\"submit\" class=\"outgoing-to-submit\" disabled>Send</button>\n    </form>\n  </div>`;\n}\n\nfunction generateLoginPageHtml(state) {\n  if(state.isLoginPending) {\n    return generateSpinnerHtml();\n  }\n  return `\n    <div class=\"login\">\n      <p class=\"login-greeting\">Welcome to JS Chat!</p>\n      <div class=\"login-main\">\n        ${state.error ? `<p class=\"login-error\">${state.error}</p>` : \"\"}\n        <form class=\"login-form\" action=\"#/login\">\n          <label class=\"login-label\">\n            <span>Username:</span>\n            <input type=\"text\" name=\"username\" class=\"login-to-send\" value=\"\" placeholder=\"Enter your username\"/>\n          </label>\n          <button type=\"submit\" class=\"login-to-submit\" disabled>Login</button>\n        </form>\n      </div>\n    </div>\n  `;\n}\n\nfunction generateSpinnerHtml() {\n  return `\n    <div class=\"spinner\">\n      <img class=\"spinner-img\" alt=\"loading\" src=\"images/loading.gif\"/>\n    </div>\n  `;\n}\n\nexport function renderHomePage({state,rootEl}) {\n  const homePageHtml = generateHomePageHtml(state);\n  rootEl.innerHTML = `${homePageHtml}`;\n}\n\nexport function renderMessageList({state, messagesEl}) {\n  const messageListHtml = generateMessageListHtml(state);\n  messagesEl.innerHTML = `${messageListHtml}`;\n}\n\nexport function renderUserList({state, usersEl}) {\n  const userListHtml = generateUserListHtml(state);\n  usersEl.innerHTML = `${userListHtml}`;\n}\n\nexport function renderLoginPage({state, rootEl}) {\n  const loginPageHtml = generateLoginPageHtml(state);\n  rootEl.innerHTML = `${loginPageHtml}`;\n}","/* Login */\nexport function fetchLogin(username) {\n  return fetch('/api/v1/session', {\n    method: 'POST',\n    headers: new Headers({\n      'content-type': 'application/json'\n    }),\n    body: JSON.stringify({ username }),\n  })\n  .catch( () => Promise.reject({ error: 'networkError' }) )\n  .then( response => {\n    if (response.ok) {\n      return response.json();\n    }\n    return response.json()\n    .catch( error => Promise.reject({ error }) )\n    .then( err => Promise.reject(err) );\n  });\n}\n\n/* Logout */\nexport function fetchLogout() {\n  return fetch('/api/v1/session', {\n    method: 'DELETE',\n  })\n  .catch( () => Promise.reject({ error: 'networkError' }) )\n  .then( response => {\n    if (response.ok) {\n      return response.json();\n    }\n    return response.json()\n    .catch( error => Promise.reject({ error }) )\n    .then( err => Promise.reject(err) );\n  });\n}\n\n/* Check for an existing session */\nexport function fetchSession() {\n  return fetch('/api/v1/session', {\n    method: 'GET',\n  })\n  .catch( () => Promise.reject({ error: 'networkError' }) )\n  .then( response => {\n    if (response.ok) {\n      return response.json();\n    }\n    return response.json()\n    .catch( error => Promise.reject({ error }) )\n    .then( err => Promise.reject(err) );\n  });\n}\n\n/* Get the list of logged-in users */\nexport function fetchLoggedInUsers() {\n  return fetch('/api/v1/users')\n  .catch( () => Promise.reject({ error: 'networkError' }) )\n  .then( response => {\n    if (response.ok) {\n      return response.json();\n    }\n    return response.json()\n    .catch( error => Promise.reject({ error }) )\n    .then( err => Promise.reject(err) );\n  });\n}\n\n/* Add a new message to the list of messages */\nexport function fetchAddMessage(message) {\n  return fetch('/api/v1/messages', {\n    method: 'POST',\n    headers: new Headers({\n      'content-type': 'application/json',\n    }),\n    body: JSON.stringify( { message } ),\n  })\n  .catch( () => Promise.reject({ error: 'networkError' }) )\n  .then( response => {\n    if (response.ok) {\n      return response.json();\n    }\n    return response.json()\n    .catch( error => Promise.reject({ error }) )\n    .then( err => Promise.reject(err) );\n  });\n}\n\n/* Get the list of messages */\nexport function fetchMessages() {\n  return fetch('/api/v1/messages')\n  .catch( () => Promise.reject({ error: 'networkError' }) )\n  .then( response => {\n    if (response.ok) {\n      return response.json();\n    }\n    return response.json()\n    .catch( error => Promise.reject({ error }) )\n    .then( err => Promise.reject(err) );\n  });\n}","import { MESSAGES } from './constants';\n\nconst state = {\n    username: '',\n    isLoggedIn: false,\n    isLoginPending: true,\n    isMessagesPending: false,\n    isUsersPending: false,\n    error: '',\n    messages: [],\n    users: [],\n    timeoutId: ''\n  };\n\n  export function waitOnLogin() {\n    state.isLoggedIn = false;\n    state.isLoginPending = true;\n    state.username = '';\n    state.error = '';\n  }\n  \n  export function login(username) {\n    state.isLoggedIn = true;\n    state.isLoginPending = false;\n    state.username = username;\n    state.error = '';\n  }\n  \n  export function logout() {\n    clearTimeout(state.timeoutId); // Cancel the polling\n    state.timeoutId = '';\n    state.username = '';\n    state.isLoggedIn = false;\n    state.isLoginPending = false;\n    state.isMessagesPending = false;\n    state.isUsersPending = false;\n    state.error = '';\n    state.users = [];\n    state.messages = [];\n  }\n\n  export function waitOnUsers() {\n    state.isUsersPending = true;\n  }\n  \n  export function setUsers(users) {\n    state.users = users;\n    state.isUsersPending = false;\n  }\n\n  export function waitOnMessages() {\n    state.isMessagesPending = true;\n  }\n  \n  export function setMessages(messages) {\n    state.messages = messages;\n    state.isMessagesPending = false;\n  }\n  \n  export function addMessage(message) {\n    state.messages.push(message);\n    state.isMessagesPending = false;\n  }\n\n  export function setTimeoutId(timeoutId) {\n    state.timeoutId = timeoutId;\n  }\n  \n  export function setError(error) {\n    if(!error) {\n      state.error = '';\n      return;\n    }\n    state.error = MESSAGES[error] || MESSAGES.default;\n  }\n  \n  export default state;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { SERVER, CLIENT } from './constants';\nimport {fetchSession} from './services'; // Offer fetch() calls to communicate with the server\nimport state, { login, logout, setError } from './state'; // The user's state in client side\nimport {renderHomePage, renderLoginPage} from './render'; // Offer the render methods to generate HTML\nimport polling from './polling'; // Set a polling to refresh the list of message and user\nimport { \n  addListenerToLogin,\n  addListenerToLogout,\n  addListenerToOutgoing,\n  addListenerToLoginSend,\n  addListenerToOutgoingSend \n} from './listeners';\n\nconst rootEl = document.querySelector('.root');\n\naddListenerToLogin({ state,  rootEl });\naddListenerToLogout({ state,  rootEl });\naddListenerToOutgoing({ state,  rootEl });\naddListenerToLoginSend(rootEl);\naddListenerToOutgoingSend(rootEl);\ncheckForSession();\n\n/* Check for an existing session */\nfunction checkForSession() {\n\n  fetchSession()\n  .catch( err => {\n    if( err?.error === SERVER.AUTH_MISSING ) {\n      return Promise.reject({ error: CLIENT.NO_SESSION }) // Expected, not a problem\n    }\n    return Promise.reject(err); // Pass any other error unchanged\n  })\n  .then( res => {\n\n    // Login successful, show home page\n    login(res.username);\n    renderHomePage({state, rootEl});\n\n    // Set polling\n    polling({state, rootEl, isFirstTime: false});\n  })\n  .catch( err => {\n\n    // If there is an error, update state and show login page\n    logout();\n    if( err?.error != CLIENT.NO_SESSION ) { // For unexpected errors, report them\n      setError(err?.error || 'ERROR');\n    }\n    renderLoginPage({state, rootEl});\n  });\n}"],"names":["SERVER","AUTH_MISSING","AUTH_INSUFFICIENT","REQUIRED_USERNAME","INVALID_USERNAME","CLIENT","NETWORK_ERROR","NO_SESSION","MESSAGES","_MESSAGES","_defineProperty","fetchLogin","fetchLogout","fetchAddMessage","waitOnMessages","addMessage","waitOnLogin","login","logout","setError","renderHomePage","renderLoginPage","renderMessageList","polling","addListenerToLogin","_ref","state","rootEl","addEventListener","e","preventDefault","target","classList","contains","username","querySelector","value","then","res","isFirstTime","err","error","addListenerToLogout","_ref2","addListenerToOutgoing","_ref3","toSendEl","sendButtonEl","messagesEl","newMessage","scrollTop","scrollHeight","disabled","addListenerToLoginSend","addListenerToOutgoingSend","setTimeoutId","fetchLoggedInUsers","fetchMessages","waitOnUsers","setUsers","setMessages","renderUserList","refreshUserList","refreshMessageList","forceScrollToBottom","id","setTimeout","usersEl","users","needScrollToBottom","clientHeight","preScrollTop","messages","generateHomePageHtml","isLoginPending","generateSpinnerHtml","concat","generateMessageListHtml","generateUserListHtml","generateOutgoingHtml","isMessagesPending","length","listHtml","map","msg","message","join","isUsersPending","user","generateLoginPageHtml","homePageHtml","innerHTML","messageListHtml","userListHtml","_ref4","loginPageHtml","fetch","method","headers","Headers","body","JSON","stringify","Promise","reject","response","ok","json","fetchSession","isLoggedIn","timeoutId","clearTimeout","push","document","checkForSession"],"sourceRoot":""}